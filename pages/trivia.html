<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trivial EndsYear</title>
  <link rel="stylesheet" href="../css/styles-pages.css" />
</head>
<body>
  <div class="container">
    <h1>Trivia Villa</h1>
    <p>¬°Demuestra tus conocimientos! Responde correctamente para avanzar.</p>

    <div id="triviaContainer">
      <h2 id="questionTitle">Cargando pregunta...</h2>
      <ul id="answersList" style="list-style: none; padding: 0;"></ul>
      <p id="triviaStatus"></p>
      <button id="nextBtn" class="hidden" style="display:none; width: 100%; padding: 10px; margin-top: 20px;">Siguiente Pregunta</button>
    </div>
  </div>

  <script>
    const questions = [
      {
        question: "¬øCu√°l es la pel√≠cula de animaci√≥n donde un robot limpia la Tierra mientras los humanos viven en el espacio?",
        answers: ["Wall-E", "Up", "Frozen", "Shrek"],
        correct: 0
      },
      {
        question: "¬øEn qu√© a√±o consigui√≥ Sant Feliu de Codines su decreto de emancipaci√≥n de Caldes?",
        answers: ["1895", "1799", "1902", "1550"],
        correct: 1
      },
      {
        question: "¬øQu√© personaje de Pixar tiene un sombrero de vaquero?",
        answers: ["Buzz Lightyear", "Woody", "Lightning McQueen", "Mike Wazowski"],
        correct: 1
      }
    ];

    let currentIndex = 0;
    const questionTitle = document.getElementById("questionTitle");
    const answersList = document.getElementById("answersList");
    const triviaStatus = document.getElementById("triviaStatus");
    const nextBtn = document.getElementById("nextBtn");

    function showQuestion() {
      // Limpiamos estado anterior
      triviaStatus.innerText = "";
      nextBtn.style.display = "none";
      answersList.innerHTML = "";
      
      const q = questions[currentIndex];
      questionTitle.innerText = q.question;

      q.answers.forEach((ans, idx) => {
        const li = document.createElement("li");
        const btn = document.createElement("button");
        btn.innerText = ans;
        btn.style.width = "100%";
        btn.style.margin = "5px 0";
        btn.style.padding = "10px";
        btn.onclick = () => checkAnswer(idx);
        li.appendChild(btn);
        answersList.appendChild(li);
      });
    }

    function checkAnswer(selected) {
      const q = questions[currentIndex];
      // Deshabilitamos botones para que no cambien la respuesta
      const buttons = answersList.querySelectorAll("button");
      buttons.forEach(b => b.disabled = true);

      if (selected === q.correct) {
        triviaStatus.innerHTML = "<b style='color: #2ecc71;'>‚úÖ ¬°Correcto!</b>";
      } else {
        triviaStatus.innerHTML = `<b style='color: #e74c3c;'>‚ùå Incorrecto.</b> La respuesta era: ${q.answers[q.correct]}`;
      }
      
      nextBtn.style.display = "block"; // Mostramos bot√≥n siguiente
    }

    nextBtn.addEventListener("click", () => {
      currentIndex++;
      if (currentIndex < questions.length) {
        showQuestion();
      } else {
        questionTitle.innerText = "üéâ ¬°Has completado la trivia!";
        answersList.innerHTML = "";
        triviaStatus.innerText = "Gracias por participar. ¬°Bienvenidos a la villa!";
        nextBtn.style.display = "none";
        
        // Redirigir a celebraci√≥n tras 3 segundos
        setTimeout(() => {
            window.location.href = "celebration.html";
        }, 3000);
      }
    });

    // REGLA DE ORO: Ejecutamos la primera pregunta al cargar
    document.addEventListener("DOMContentLoaded", showQuestion);
  </script>
</body>
</html>
